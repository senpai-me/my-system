<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SENSEI WORLD V6</title>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, doc, setDoc, getDoc, updateDoc, arrayUnion, increment } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // Yahan apni Firebase Config paste karein (Jo aapne dashboard se li thi)
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_PROJECT.firebaseapp.com",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_PROJECT.appspot.com",
            messagingSenderId: "YOUR_ID",
            appId: "YOUR_APP_ID"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // --- Global Logic ---
        window.startApp = function() {
            const intro = document.getElementById('intro-screen');
            const splash = document.getElementById('liquid-splash');
            const dragon = document.getElementById('flying-dragon');

            dragon.style.display = "block";
            splash.style.transform = "scale(50)"; // Liquid splash effect
            
            setTimeout(() => {
                intro.style.display = 'none';
                checkAuthStatus();
            }, 3000);
        };

        function checkAuthStatus() {
            onAuthStateChanged(auth, (user) => {
                if (user || sessionStorage.getItem('guestMode')) {
                    document.getElementById('auth-overlay').style.display = 'none';
                    document.getElementById('main-wrapper').style.display = 'block';
                    updateVisitCounter(user ? user.displayName : "Guest");
                } else {
                    document.getElementById('auth-overlay').style.display = 'flex';
                }
            });
        }

        // --- Counter & History Logic ---
        async function updateVisitCounter(name) {
            const counterRef = doc(db, "stats", "global");
            await updateDoc(counterRef, {
                visits: increment(1),
                history: arrayUnion({ user: name, time: new Date().toLocaleString() })
            });
            const snap = await getDoc(counterRef);
            document.getElementById('visit-count').innerText = snap.data().visits;
        }

        // --- Exporting functions to Global Window ---
        window.handleAuth = async (type) => {
            const email = document.getElementById('email').value;
            const pass = document.getElementById('pass').value;
            const userN = document.getElementById('reg-username').value;

            try {
                if(type === 'signup') {
                    const res = await createUserWithEmailAndPassword(auth, email, pass);
                    // Save username in Firestore
                    await setDoc(doc(db, "users", res.user.uid), { username: userN });
                } else {
                    await signInWithEmailAndPassword(auth, email, pass);
                }
                location.reload();
            } catch (err) { alert(err.message); }
        };
    </script>

    <style>
        :root { --neon-blue: #00d2ff; --neon-pink: #ff0055; --neon-green: #39ff14; }
        body, html { margin: 0; padding: 0; height: 100%; background: #000; color: #fff; font-family: 'Segoe UI', sans-serif; overflow-x: hidden; }

        /* 1. Intro Screen & Liquid Splash */
        #intro-screen {
            position: fixed; inset: 0; z-index: 9999; background: #000;
            display: flex; justify-content: center; align-items: center;
        }
        .get-started {
            padding: 20px 40px; border: 2px solid var(--neon-blue); color: var(--neon-blue);
            font-size: 2rem; background: none; cursor: pointer; border-radius: 50px;
            transition: 0.5s; z-index: 10001;
        }
        #liquid-splash {
            position: absolute; width: 100px; height: 100px; background: var(--neon-pink);
            border-radius: 50%; filter: blur(20px); transition: 3s ease-in-out;
            transform: scale(0); z-index: 10000; pointer-events: none;
        }
        #flying-dragon {
            position: absolute; font-size: 40px; display: none;
            animation: fly 3s linear forwards; z-index: 10002;
        }
        @keyframes fly {
            0% { top: 10%; left: -10%; transform: rotate(20deg); }
            100% { top: 90%; left: 110%; transform: rotate(0deg); }
        }

        /* 2. Auth Interface */
        #auth-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.95);
            z-index: 5000; display: none; flex-direction: column; align-items: center; justify-content: center;
        }
        .guest-link { position: absolute; top: 20px; right: 20px; color: #aaa; text-decoration: none; font-size: 1.2rem; }
        .auth-card { background: #111; padding: 30px; border-radius: 20px; border: 1px solid var(--neon-blue); width: 320px; }
        .auth-card input { width: 100%; padding: 12px; margin: 10px 0; background: #222; border: 1px solid #444; color: #fff; box-sizing: border-box; }
        .pw-container { position: relative; }
        .toggle-pw { position: absolute; right: 10px; top: 18px; font-size: 10px; cursor: pointer; color: var(--neon-blue); }

        /* 3. Main Wrapper & Visit Stats */
        #main-wrapper { display: none; }
        .visit-stats {
            position: fixed; top: 20px; right: 20px; z-index: 100;
            display: flex; align-items: center; color: var(--neon-green);
            cursor: pointer; font-family: monospace; font-size: 18px;
        }

        /* 4. Comments & User Style */
        .user-tag { color: var(--neon-green); font-style: italic; border-bottom: 1px dashed var(--neon-green); }
        .comment-section { margin-top: 50px; border-top: 1px solid #333; padding-top: 20px; }
        .comment-trigger { color: var(--neon-blue); cursor: pointer; text-decoration: underline; }

        /* Background Fix */
        .bg-container { position: fixed; inset: 0; background: url('./oh.jpg') center/cover; filter: brightness(0.3); z-index: -1; }
        .main-container { max-width: 700px; margin: 50px auto; background: rgba(0,0,0,0.7); backdrop-filter: blur(10px); padding: 30px; border-radius: 30px; text-align: center; }
        
        /* Gallery Styles */
        .anime-gallery { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 30px 0; }
        .image-card { border-radius: 15px; border: 2px solid var(--neon-blue); overflow: hidden; position: relative; }
        .image-card img { width: 100%; height: 200px; object-fit: cover; }
    </style>
</head>
<body>

    <div class="bg-container"></div>

    <div id="intro-screen">
        <div id="liquid-splash"></div>
        <div id="flying-dragon">üêâ</div>
        <button class="get-started" onclick="startApp()">GET STARTED</button>
    </div>

    <div class="visit-stats" onclick="showVisitHistory()">
        <span id="visit-count">0</span> &nbsp; ‚åö
    </div>

    <div id="auth-overlay">
        <a href="#" class="guest-link" onclick="sessionStorage.setItem('guestMode', 'true'); location.reload()">GUEST ‚ûî</a>
        <div class="auth-card" id="login-form">
            <h2 style="color:var(--neon-pink)">LOGIN</h2>
            <input type="email" id="email" placeholder="Email">
            <div class="pw-container">
                <input type="password" id="pass" placeholder="Password">
                <span class="toggle-pw" onclick="togglePW()">SHOW</span>
            </div>
            <button onclick="handleAuth('login
