<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SENSEI WORLD V6 - PRO</title>
    
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut, updateProfile } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, doc, setDoc, getDoc, updateDoc, arrayUnion, increment, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // 1. APNI CONFIG YAHAN PASTE KAREIN
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_PROJECT.firebaseapp.com",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_PROJECT.appspot.com",
            messagingSenderId: "YOUR_ID",
            appId: "YOUR_APP_ID"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // --- Core Logic ---
        window.startApp = function() {
            const splash = document.getElementById('liquid-splash');
            splash.style.transform = "scale(100)"; 
            setTimeout(() => {
                document.getElementById('intro-screen').style.display = 'none';
                checkAuthStatus();
            }, 1500);
        };

        function checkAuthStatus() {
            onAuthStateChanged(auth, (user) => {
                if (user || sessionStorage.getItem('guestMode')) {
                    document.getElementById('auth-overlay').style.display = 'none';
                    document.getElementById('main-wrapper').style.display = 'block';
                    const name = user ? (user.displayName || "Sensei") : "Guest";
                    document.getElementById('display-user').innerText = name;
                    setupRealtimeData();
                } else {
                    document.getElementById('auth-overlay').style.display = 'flex';
                }
            });
        }

        // --- Realtime Comments & Likes ---
        function setupRealtimeData() {
            const docRef = doc(db, "interactions", "main_page");
            onSnapshot(docRef, (snap) => {
                if (snap.exists()) {
                    const data = snap.data();
                    document.getElementById('visit-count').innerText = data.visits || 0;
                    document.getElementById('like-count').innerText = data.likes || 0;
                    
                    const commentBox = document.getElementById('comments-display');
                    commentBox.innerHTML = "";
                    if(data.comments) {
                        data.comments.slice().reverse().forEach(c => {
                            commentBox.innerHTML += `<div style="margin-bottom:8px;"><b style="color:var(--neon-green)">${c.user}:</b> ${c.text}</div>`;
                        });
                    }
                }
            });
        }

        // --- Auth Actions ---
        window.handleAuth = async (type) => {
            const userN = document.getElementById('username').value;
            const pass = document.getElementById('pass').value;
            const email = userN + "@sensei.com";

            if(!userN || !pass) return alert("Details bharo bhai!");

            try {
                if(type === 'signup') {
                    const res = await createUserWithEmailAndPassword(auth, email, pass);
                    await updateProfile(res.user, { displayName: userN });
                    alert("Account Created! Now Login.");
                    toggleAuthMode();
                } else {
                    await signInWithEmailAndPassword(auth, email, pass);
                }
            } catch (err) { alert(err.message); }
        };

        window.postComment = async () => {
            if(sessionStorage.getItem('guestMode')) return alert("Bhai, Guest comment nahi kar sakte!");
            const text = document.getElementById('comment-input').value;
            if(!text) return;

            const docRef = doc(db, "interactions", "main_page");
            await updateDoc(docRef, {
                comments: arrayUnion({ user: auth.currentUser.displayName, text: text, time: Date.now() })
            });
            document.getElementById('comment-input').value = "";
        };

        window.handleLike = async () => {
            if(sessionStorage.getItem('guestMode')) return alert("Login to like!");
            await updateDoc(doc(db, "interactions", "main_page"), { likes: increment(1) });
        };

        window.logout = () => { signOut(auth).then(() => { sessionStorage.clear(); location.reload(); }); };
    </script>

    <style>
        :root { --neon-blue: #00d2ff; --neon-pink: #ff0055; --neon-green: #39ff14; }
        body, html { margin: 0; padding: 0; min-height: 100%; background: #000; color: #fff; font-family: 'Segoe UI', sans-serif; }
        .bg-container { position: fixed; inset: 0; background: url('./oh.jpg') center/cover; filter: brightness(0.3); z-index: -1; }

        /* Intro */
        #intro-screen { position: fixed; inset: 0; z-index: 9999; background: #000; display: flex; justify-content: center; align-items: center; overflow: hidden
